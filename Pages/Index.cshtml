@page
@model IndexModel
@using System.Net.Http.Headers
@using WhatsappBusiness.CloudApi
@using WhatsappBusiness.CloudApi.Configurations
@using WhatsappBusiness.CloudApi.Interfaces
@{
    ViewData["Title"] = "Home page";

    //TOKEN
    string token = "EAAPdbIEju9UBO8JtteMMtTAMFIjy8GrzUWDrVIDoaT11UZBOjoyFHlTB3I8En8WD7QJTs6ZARWqvr0FWWLyWZCYPwDf7ViPPfc9ZBAfUwYuI1HPItzW2bqAMerapkHZArAi1ZCGZCyFTkC1n3Hq9Do80fkdqlSGfbXspUqEQ70u2IZCVhZCf9xAryIUxOlXs5lK3rlfp155XPMcAnBpOvucIizPriTZCoZD";

    //TELEFONO API
    string idTelfono = "446912295174914";

    //TELEFONO A ENVIAR
    string telefono = "526441451514";

    HttpClient client = new HttpClient();



    HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, "https://graph.facebook.com/v15.0/" + idTelfono + "/messages");

    request.Headers.Add("Authorization", "Bearer " + token);

    request.Content = new StringContent("{ \"messaging_product\": \"whatsapp\", \"to\": \"" + telefono + "\", \"type\": \"template\", \"template\": { \"name\": \"hello_world\", \"language\": { \"code\": \"en_US\" } } }");
    request.Content.Headers.ContentType = new MediaTypeHeaderValue("application/json");

    HttpResponseMessage response = await client.SendAsync(request);
    //response.EnsureSuccessStatusCode();
    string responseBody = await response.Content.ReadAsStringAsync();    

}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
    <textarea></textarea>
</div>
